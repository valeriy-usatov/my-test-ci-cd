# 1Ô∏è‚É£ –ò—Å–ø–æ–ª—å–∑—É–µ–º –ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π –æ–±—Ä–∞–∑ Node.js –¥–ª—è —Å–±–æ—Ä–∫–∏
FROM node:18-alpine AS builder

# 2Ô∏è‚É£ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–±–æ—á—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
WORKDIR /app

# 3Ô∏è‚É£ –ö–æ–ø–∏—Ä—É–µ–º package.json –∏ package-lock.json (–∏–ª–∏ yarn.lock)
COPY package.json package-lock.json ./

# 4Ô∏è‚É£ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
RUN npm ci

# 5Ô∏è‚É£ –ö–æ–ø–∏—Ä—É–µ–º –≤–µ—Å—å –∫–æ–¥ –ø—Ä–æ–µ–∫—Ç–∞
COPY . .

# 6Ô∏è‚É£ –°–æ–±–∏—Ä–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
RUN npm run build

# 7Ô∏è‚É£ –ò—Å–ø–æ–ª—å–∑—É–µ–º –ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
FROM nginx:alpine AS runner

# 8Ô∏è‚É£ –ö–æ–ø–∏—Ä—É–µ–º —Å–æ–±—Ä–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ –ø–∞–ø–∫—É nginx
COPY --from=builder /app/dist /usr/share/nginx/html

# 9Ô∏è‚É£ –û—Ç–∫—Ä—ã–≤–∞–µ–º –ø–æ—Ä—Ç 80 –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞
EXPOSE 80

# üîü –ó–∞–ø—É—Å–∫–∞–µ–º Nginx
CMD ["nginx", "-g", "daemon off;"]
