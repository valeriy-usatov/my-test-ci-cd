deploy:
  name: Deploy to Server
  needs: test
  runs-on: ubuntu-latest

  steps:
    - name: Checkout code
      uses: actions/checkout@v3

    - name: Print environment variables (for debugging)
      run: |
        echo "GITHUB_ACTOR: $GITHUB_ACTOR"
        echo "GITHUB_REPOSITORY: $GITHUB_REPOSITORY"
        echo "GITHUB_SHA: $GITHUB_SHA"
        echo "HOST: ${{ secrets.HOST }}"
        echo "USERNAME: ${{ secrets.SSH_USERNAME }}"

    - name: Deploy via SSH
      uses: appleboy/ssh-action@v0.1.7
      with:
        host: 88.218.168.129
        username: root
        key: ${{ secrets.SSH_PRIVATE_KEY }}
        script: |
          echo "SSH connection test"
          cd /path/to/project
          git pull origin main
          docker network create my_network || true
          docker-compose up --build -d
